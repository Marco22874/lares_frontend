---
/**
 * @file SEOHead.astro
 * @author Marco De Luca
 * @date 2026-02-11
 * @description SEO meta tags component with support
 *              for multilingual hreflang, Open Graph,
 *              Twitter Card, JSON-LD structured data,
 *              and complete favicon set.
 *
 * @param {string} title - Page title
 * @param {string} description - Meta description
 * @param {string} locale - Current language code
 * @param {string} path - Current page path
 * @param {string} image - OG image URL (optional)
 * @param {boolean} noindex - Exclude from indexing
 * @param {string} jsonLdType - JSON-LD type
 * @returns Rendered meta tags in <head>
 * @update 2026-02-19
 */

import {
  SUPPORTED_LOCALES,
} from '@lib/i18n.js';

interface Props
{
  title: string;
  description: string;
  locale: string;
  path?: string;
  image?: string;
  noindex?: boolean;
  jsonLdType?: 'Organization' | 'WebPage';
}

const {
  title,
  description,
  locale,
  path = '',
  image = '',
  noindex = false,
  jsonLdType = 'WebPage',
} = Astro.props;

const siteUrl =
  import.meta.env.PUBLIC_SITE_URL ||
  'https://larescohousing.it';

const canonicalUrl = `${siteUrl}/${locale}/${path}`;

const langMap: Record<string, string> =
{
  it: 'it-IT',
  en: 'en-US',
  de: 'de-DE',
  fr: 'fr-FR',
};

const fullTitle = `${title} | Lares Cohousing`;

const jsonLd = jsonLdType === 'Organization'
  ? {
      '@context': 'https://schema.org',
      '@type': 'Organization',
      name: 'Lares Cohousing',
      url: siteUrl,
      logo: `${siteUrl}/LARES_LOGO_2.webp`,
      description: description,
      address:
      {
        '@type': 'PostalAddress',
        streetAddress: 'Via Vespucci 13/15',
        addressLocality: 'Taurisano',
        addressRegion: 'LE',
        postalCode: '73056',
        addressCountry: 'IT',
      },
      contactPoint:
      {
        '@type': 'ContactPoint',
        telephone: '+39-0833-193-5512',
        email: 'info@larescohousing.it',
        contactType: 'customer service',
      },
    }
  : {
      '@context': 'https://schema.org',
      '@type': 'WebPage',
      name: fullTitle,
      url: canonicalUrl,
      description: description,
      inLanguage: langMap[locale],
      isPartOf:
      {
        '@type': 'WebSite',
        name: 'Lares Cohousing',
        url: siteUrl,
      },
    };
---

<meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1"
/>
<title>{fullTitle}</title>
<meta name="description" content={description} />

{/* Robots */}
{noindex && (
  <meta name="robots" content="noindex" />
)}

{/* Theme color */}
<meta name="theme-color" content="#0e3d45" />

{/* Canonical */}
<link rel="canonical" href={canonicalUrl} />

{/* Hreflang tags for all supported locales */}
{SUPPORTED_LOCALES.map((lang) => (
  <link
    rel="alternate"
    hreflang={langMap[lang]}
    href={`${siteUrl}/${lang}/${path}`}
  />
))}
<link
  rel="alternate"
  hreflang="x-default"
  href={`${siteUrl}/it/${path}`}
/>

{/* Favicon */}
<link
  rel="icon"
  type="image/png"
  sizes="32x32"
  href="/favicon-32x32.png"
/>
<link
  rel="icon"
  type="image/png"
  sizes="16x16"
  href="/favicon-16x16.png"
/>
<link
  rel="icon"
  href="/favicon.ico"
  sizes="32x32"
/>
<link
  rel="apple-touch-icon"
  sizes="180x180"
  href="/apple-touch-icon.png"
/>
<link
  rel="manifest"
  href="/site.webmanifest"
/>

{/* Open Graph */}
<meta property="og:type" content="website" />
<meta
  property="og:site_name"
  content="Lares Cohousing"
/>
<meta
  property="og:title"
  content={fullTitle}
/>
<meta
  property="og:description"
  content={description}
/>
<meta property="og:url" content={canonicalUrl} />
<meta
  property="og:locale"
  content={langMap[locale]}
/>
{image && (
  <>
    <meta property="og:image" content={image} />
    <meta property="og:image:width" content="1200" />
    <meta
      property="og:image:height"
      content="630"
    />
    <meta
      property="og:image:alt"
      content={fullTitle}
    />
  </>
)}

{/* Twitter Card */}
<meta
  name="twitter:card"
  content="summary_large_image"
/>
<meta name="twitter:title" content={fullTitle} />
<meta
  name="twitter:description"
  content={description}
/>
{image && (
  <meta name="twitter:image" content={image} />
)}

{/* Google Fonts - Onest */}
<link
  rel="preconnect"
  href="https://fonts.googleapis.com"
/>
<link
  rel="preconnect"
  href="https://fonts.gstatic.com"
  crossorigin
/>
<link
  href="https://fonts.googleapis.com/css2?family=Onest:wght@300;400;500;600;700&display=swap"
  rel="stylesheet"
/>

{/* JSON-LD Structured Data */}
<script
  type="application/ld+json"
  set:html={JSON.stringify(jsonLd)}
/>
