---
/**
 * @file it/index.astro
 * @author Marco De Luca
 * @date 2026-02-11
 * @description Home page (Italian). Displays hero
 *              section, intro text, services preview,
 *              and call-to-action. Content fetched
 *              from Directus at build time.
 *
 * @returns Rendered home page
 * @update 2026-02-11
 * @update 2026-02-20 - Integrated Directus content
 */

import BaseLayout from '@layouts/BaseLayout.astro';
import { t, localizedPath } from '@lib/i18n.js';
import {
  getItemBySlug,
  getSiteSettings,
} from '@lib/directus.js';

const locale = 'it';

// Fetch page content from Directus
const page = await getItemBySlug(
  'pages', 'home', locale
);
const settings = await getSiteSettings(locale);

// Extract translated fields
const tr = page?.translations?.[0] || {};
const settingsTr = settings?.translations?.[0] || {};
const pageTitle = tr.title || 'Lares Cohousing';
const pageContent = tr.content || '';
const tagline = settingsTr.tagline
  || 'Vivere insieme, vivere meglio.';
---

<BaseLayout
  title="Home"
  description={`Lares Cohousing - ${tagline}`}
  locale={locale}
  currentPath="home"
>
  <section class="hero">
    <div class="hero__overlay"></div>
    <div class="hero__content">
      <h1 class="hero__title">
        {settings?.site_name || 'Lares Cohousing'}
      </h1>
      <p class="hero__subtitle">
        {tagline}
      </p>
      <a
        href={localizedPath(locale, 'about')}
        class="btn btn--primary"
      >
        {t(locale, 'nav_about')}
      </a>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <h2 class="section__title">
        {pageTitle}
      </h2>
      <div set:html={pageContent} />
    </div>
  </section>

  <section class="section section--alt">
    <div class="container">
      <h2 class="section__title">
        {t(locale, 'nav_services')}
      </h2>
      <div class="grid grid--3">
        <!-- ServiceCards from Directus -->
      </div>
      <div class="text-center mt-xl">
        <a
          href={localizedPath(locale, 'services')}
          class="btn btn--outline"
        >
          {t(locale, 'nav_services')}
        </a>
      </div>
    </div>
  </section>
</BaseLayout>
